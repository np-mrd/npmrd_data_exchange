from .align import MolBlockAligner

"""
HOW TO RUN:
Navigate your terminal to the parent directory of this file and run...
`python -m alignment.align_example`
"""

example_curation_block = """
     RDKit          3D

 53 56  0  0  0  0  0  0  0  0999 V2000
    0.1372    1.6257   -0.5189 O   0  0  0  0  0  0  0  0  0  1  0  0
    1.1248    0.8294   -0.3735 C   0  0  0  0  0  0  0  0  0  2  0  0
    2.5133    1.3600   -0.4444 C   0  0  0  0  0  0  0  0  0  3  0  0
    3.3940    0.4789    0.3778 C   0  0  2  0  0  0  0  0  0  4  0  0
    4.8291    0.7705    0.2263 C   0  0  0  0  0  0  0  0  0  5  0  0
    5.7658   -0.1591    0.6368 C   0  0  0  0  0  0  0  0  0  6  0  0
    7.1266    0.0722    0.5139 C   0  0  0  0  0  0  0  0  0  7  0  0
    7.5965    1.2517   -0.0286 C   0  0  0  0  0  0  0  0  0  8  0  0
    8.9758    1.4919   -0.1557 O   0  0  0  0  0  0  0  0  0  9  0  0
    6.6694    2.1849   -0.4408 C   0  0  0  0  0  0  0  0  0 10  0  0
    5.3169    1.9437   -0.3136 C   0  0  0  0  0  0  0  0  0 11  0  0
    3.1715   -0.8657   -0.0681 O   0  0  0  0  0  0  0  0  0 12  0  0
    1.9078   -1.4298    0.0115 C   0  0  0  0  0  0  0  0  0 13  0  0
    1.6777   -2.7780    0.2334 C   0  0  0  0  0  0  0  0  0 14  0  0
    0.3936   -3.2731    0.3012 C   0  0  0  0  0  0  0  0  0 15  0  0
    0.1299   -4.6122    0.5212 O   0  0  0  0  0  0  0  0  0 16  0  0
   -0.6847   -2.3959    0.1429 C   0  0  0  0  0  0  0  0  0 17  0  0
   -0.4793   -1.0524   -0.0784 C   0  0  0  0  0  0  0  0  0 18  0  0
   -1.5033   -0.1832   -0.2348 O   0  0  0  0  0  0  0  0  0 19  0  0
   -2.8726   -0.3854   -0.2176 C   0  0  2  0  0  0  0  0  0 20  0  0
   -3.4191    0.0523   -1.4188 O   0  0  0  0  0  0  0  0  0 21  0  0
   -4.7862   -0.0365   -1.4690 C   0  0  2  0  0  0  0  0  0 22  0  0
   -5.2300    0.4167   -2.8460 C   0  0  0  0  0  0  0  0  0 23  0  0
   -4.6388   -0.4257   -3.7823 O   0  0  0  0  0  0  0  0  0 24  0  0
   -5.3819    0.8991   -0.4103 C   0  0  1  0  0  0  0  0  0 25  0  0
   -6.7634    0.9677   -0.5256 O   0  0  0  0  0  0  0  0  0 26  0  0
   -4.9571    0.3130    0.9312 C   0  0  2  0  0  0  0  0  0 27  0  0
   -5.5018    0.9801    1.9988 O   0  0  0  0  0  0  0  0  0 28  0  0
   -3.4446    0.3768    0.9662 C   0  0  1  0  0  0  0  0  0 29  0  0
   -3.0415   -0.3396    2.1113 O   0  0  0  0  0  0  0  0  0 30  0  0
    0.8220   -0.5778   -0.1427 C   0  0  0  0  0  0  0  0  0 31  0  0
    2.8386    1.3625   -1.5185 H   0  0  0  0  0  0  0  0  0 32  0  0
    2.5301    2.4227   -0.0921 H   0  0  0  0  0  0  0  0  0 33  0  0
    3.0922    0.5810    1.4347 H   0  0  0  0  0  0  0  0  0 34  0  0
    5.4580   -1.1046    1.0707 H   0  0  0  0  0  0  0  0  0 35  0  0
    7.8706   -0.6441    0.8298 H   0  0  0  0  0  0  0  0  0 36  0  0
    9.4870    1.2232   -0.9941 H   0  0  0  0  0  0  0  0  0 37  0  0
    7.0131    3.1176   -0.8695 H   0  0  0  0  0  0  0  0  0 38  0  0
    4.6230    2.6901   -0.6441 H   0  0  0  0  0  0  0  0  0 39  0  0
    2.5187   -3.4352    0.3526 H   0  0  0  0  0  0  0  0  0 40  0  0
    0.0246   -4.9480    1.4881 H   0  0  0  0  0  0  0  0  0 41  0  0
   -1.6629   -2.8428    0.2063 H   0  0  0  0  0  0  0  0  0 42  0  0
   -3.0947   -1.4473   -0.0464 H   0  0  0  0  0  0  0  0  0 43  0  0
   -5.1884   -1.0348   -1.2469 H   0  0  0  0  0  0  0  0  0 44  0  0
   -6.3440    0.2958   -2.9714 H   0  0  0  0  0  0  0  0  0 45  0  0
   -4.9566    1.4729   -3.0121 H   0  0  0  0  0  0  0  0  0 46  0  0
   -4.4362   -1.3185   -3.4071 H   0  0  0  0  0  0  0  0  0 47  0  0
   -4.9378    1.9066   -0.4772 H   0  0  0  0  0  0  0  0  0 48  0  0
   -6.9540    1.5027   -1.3364 H   0  0  0  0  0  0  0  0  0 49  0  0
   -5.2488   -0.7678    0.8842 H   0  0  0  0  0  0  0  0  0 50  0  0
   -5.9943    1.8037    1.7539 H   0  0  0  0  0  0  0  0  0 51  0  0
   -3.1236    1.4257    0.9950 H   0  0  0  0  0  0  0  0  0 52  0  0
   -2.3625    0.2388    2.5678 H   0  0  0  0  0  0  0  0  0 53  0  0
  1  2  2  0
  2  3  1  0
  3  4  1  0
  4  5  1  0
  5  6  2  0
  6  7  1  0
  7  8  2  0
  8  9  1  0
  8 10  1  0
 10 11  2  0
  4 12  1  0
 12 13  1  0
 13 14  2  0
 14 15  1  0
 15 16  1  0
 15 17  2  0
 17 18  1  0
 18 19  1  0
 19 20  1  0
 20 21  1  0
 21 22  1  0
 22 23  1  0
 23 24  1  0
 22 25  1  0
 25 26  1  0
 25 27  1  0
 27 28  1  0
 27 29  1  0
 29 30  1  0
 18 31  2  0
 31  2  1  0
 11  5  1  0
 31 13  1  0
 29 20  1  0
  3 32  1  0
  3 33  1  0
  4 34  1  1
  6 35  1  0
  7 36  1  0
  9 37  1  0
 10 38  1  0
 11 39  1  0
 14 40  1  0
 16 41  1  0
 17 42  1  0
 20 43  1  1
 22 44  1  1
 23 45  1  0
 23 46  1  0
 24 47  1  0
 25 48  1  6
 26 49  1  0
 27 50  1  6
 28 51  1  0
 29 52  1  1
 30 53  1  0
M  END
"""

example_db_block = """
     RDKit          3D

 53 56  0  0  0  0  0  0  0  0999 V2000
   -1.4984   -0.7742    0.7149 O   0  0  0  0  0  0  0  0  0  0  0  0
   -0.5243   -1.0285   -0.2662 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.8119   -0.6306   -0.0329 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.7960   -0.8835   -1.0086 C   0  0  0  0  0  0  0  0  0  0  0  0
    3.1280   -0.5172   -0.7810 O   0  0  0  0  0  0  0  0  0  0  0  0
    3.6112   -0.1821    0.5223 C   0  0  2  0  0  0  0  0  0  0  0  0
    2.5985    0.7062    1.2608 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.2307    0.0892    1.1964 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.4424    0.2377    2.1685 O   0  0  0  0  0  0  0  0  0  0  0  0
    4.9497    0.5071    0.4170 C   0  0  0  0  0  0  0  0  0  0  0  0
    5.9812    0.1903    1.3172 C   0  0  0  0  0  0  0  0  0  0  0  0
    7.2123    0.8488    1.2414 C   0  0  0  0  0  0  0  0  0  0  0  0
    7.4229    1.8388    0.2724 C   0  0  0  0  0  0  0  0  0  0  0  0
    8.6454    2.5012    0.1875 O   0  0  0  0  0  0  0  0  0  0  0  0
    6.3956    2.1684   -0.6170 C   0  0  0  0  0  0  0  0  0  0  0  0
    5.1635    1.5117   -0.5437 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.4522   -1.4958   -2.2148 C   0  0  0  0  0  0  0  0  0  0  0  0
    0.1358   -1.8911   -2.4530 C   0  0  0  0  0  0  0  0  0  0  0  0
   -0.1862   -2.5105   -3.6589 O   0  0  0  0  0  0  0  0  0  0  0  0
   -0.8475   -1.6656   -1.4821 C   0  0  0  0  0  0  0  0  0  0  0  0
   -2.8928   -1.0535    0.5906 C   0  0  2  0  0  0  0  0  0  0  0  0
   -3.4177   -0.2729   -0.4756 O   0  0  0  0  0  0  0  0  0  0  0  0
   -4.8313   -0.3313   -0.4874 C   0  0  2  0  0  0  0  0  0  0  0  0
   -5.3496    0.1774   -1.8408 C   0  0  0  0  0  0  0  0  0  0  0  0
   -4.9070    1.4846   -2.0956 O   0  0  0  0  0  0  0  0  0  0  0  0
   -5.4125    0.4884    0.6959 C   0  0  1  0  0  0  0  0  0  0  0  0
   -6.6167   -0.1042    1.1132 O   0  0  0  0  0  0  0  0  0  0  0  0
   -4.4100    0.5468    1.8751 C   0  0  2  0  0  0  0  0  0  0  0  0
   -3.5516    1.6461    1.6965 O   0  0  0  0  0  0  0  0  0  0  0  0
   -3.5819   -0.7500    1.9556 C   0  0  1  0  0  0  0  0  0  0  0  0
   -4.4282   -1.8117    2.3185 O   0  0  0  0  0  0  0  0  0  0  0  0
    3.7239   -1.1308    1.0945 H   0  0  0  0  0  0  0  0  0  0  0  0
    2.9125    0.8273    2.3209 H   0  0  0  0  0  0  0  0  0  0  0  0
    2.5514    1.7111    0.7879 H   0  0  0  0  0  0  0  0  0  0  0  0
    5.8330   -0.5654    2.0787 H   0  0  0  0  0  0  0  0  0  0  0  0
    8.0001    0.5915    1.9379 H   0  0  0  0  0  0  0  0  0  0  0  0
    9.4090    2.2860    0.8179 H   0  0  0  0  0  0  0  0  0  0  0  0
    6.5508    2.9370   -1.3634 H   0  0  0  0  0  0  0  0  0  0  0  0
    4.3758    1.7878   -1.2336 H   0  0  0  0  0  0  0  0  0  0  0  0
    2.2135   -1.6761   -2.9635 H   0  0  0  0  0  0  0  0  0  0  0  0
   -1.1319   -2.8109   -3.8648 H   0  0  0  0  0  0  0  0  0  0  0  0
   -1.8589   -1.9856   -1.6893 H   0  0  0  0  0  0  0  0  0  0  0  0
   -3.0074   -2.1359    0.3525 H   0  0  0  0  0  0  0  0  0  0  0  0
   -5.1693   -1.3930   -0.4047 H   0  0  0  0  0  0  0  0  0  0  0  0
   -5.0152   -0.5091   -2.6524 H   0  0  0  0  0  0  0  0  0  0  0  0
   -6.4606    0.1698   -1.8382 H   0  0  0  0  0  0  0  0  0  0  0  0
   -3.9749    1.4119   -2.4293 H   0  0  0  0  0  0  0  0  0  0  0  0
   -5.6181    1.5347    0.3658 H   0  0  0  0  0  0  0  0  0  0  0  0
   -7.1093    0.5796    1.6384 H   0  0  0  0  0  0  0  0  0  0  0  0
   -4.9750    0.6811    2.8280 H   0  0  0  0  0  0  0  0  0  0  0  0
   -3.1167    1.8189    2.5724 H   0  0  0  0  0  0  0  0  0  0  0  0
   -2.8114   -0.6191    2.7525 H   0  0  0  0  0  0  0  0  0  0  0  0
   -3.8432   -2.5508    2.6307 H   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  1  0
  2  3  2  0
  3  4  1  0
  4  5  1  0
  5  6  1  0
  6  7  1  0
  7  8  1  0
  8  9  2  0
  6 10  1  0
 10 11  2  0
 11 12  1  0
 12 13  2  0
 13 14  1  0
 13 15  1  0
 15 16  2  0
  4 17  2  0
 17 18  1  0
 18 19  1  0
 18 20  2  0
  1 21  1  0
 21 22  1  0
 22 23  1  0
 23 24  1  0
 24 25  1  0
 23 26  1  0
 26 27  1  0
 26 28  1  0
 28 29  1  0
 28 30  1  0
 30 31  1  0
 20  2  1  0
  8  3  1  0
 16 10  1  0
 30 21  1  0
  6 32  1  1
  7 33  1  0
  7 34  1  0
 11 35  1  0
 12 36  1  0
 14 37  1  0
 15 38  1  0
 16 39  1  0
 17 40  1  0
 19 41  1  0
 20 42  1  0
 21 43  1  6
 23 44  1  1
 24 45  1  0
 24 46  1  0
 25 47  1  0
 26 48  1  6
 27 49  1  0
 28 50  1  1
 29 51  1  0
 30 52  1  1
 31 53  1  0
M  END
"""

example_c_values = [
        {
          "rdkit_index": 4,
          "shift": 78.1,
          "atom_index": "2"
        },
        {
          "rdkit_index": 3,
          "shift": 44.5,
          "atom_index": "3"
        },
        {
          "rdkit_index": 2,
          "shift": 189.3,
          "atom_index": "4"
        },
        {
          "rdkit_index": 18,
          "shift": 159.9,
          "atom_index": "5"
        },
        {
          "rdkit_index": 17,
          "shift": 98.8,
          "atom_index": "6"
        },
        {
          "rdkit_index": 15,
          "shift": 164.6,
          "atom_index": "7"
        },
        {
          "rdkit_index": 14,
          "shift": 97.7,
          "atom_index": "8"
        },
        {
          "rdkit_index": 13,
          "shift": 163.6,
          "atom_index": "9"
        },
        {
          "rdkit_index": 31,
          "shift": 105.1,
          "atom_index": "10"
        },
        {
          "rdkit_index": 5,
          "shift": 129,
          "atom_index": "1'"
        },
        {
          "rdkit_index": 6,
          "shift": 128.3,
          "atom_index": "2'"
        },
        {
          "rdkit_index": 7,
          "shift": 115,
          "atom_index": "3'"
        },
        {
          "rdkit_index": 8,
          "shift": 157.4,
          "atom_index": "4'"
        },
        {
          "rdkit_index": 10,
          "shift": 115,
          "atom_index": "5'"
        },
        {
          "rdkit_index": 11,
          "shift": 128.3,
          "atom_index": "6'"
        },
        {
          "rdkit_index": 20,
          "shift": 102.2,
          "atom_index": "1''"
        },
        {
          "rdkit_index": 29,
          "shift": 73.3,
          "atom_index": "2''"
        },
        {
          "rdkit_index": 27,
          "shift": 75.9,
          "atom_index": "3''"
        },
        {
          "rdkit_index": 25,
          "shift": 69.4,
          "atom_index": "4''"
        },
        {
          "rdkit_index": 22,
          "shift": 77.3,
          "atom_index": "5''"
        },
        {
          "rdkit_index": 23,
          "shift": 60.5,
          "atom_index": "6''"
        }
]

example_h_values = [
        {
          "shift": 5.38,
          "multiplicity": "dd",
          "coupling": [
            13.1,
            2.1
          ],
          "atom_index": "2",
          "rdkit_index": [
            34
          ],
          "interchangable_index": []
        },
        {
          "shift": 3.08,
          "multiplicity": None,
          "coupling": [],
          "atom_index": "3\u03b1",
          "rdkit_index": [
            33
          ],
          "interchangable_index": []
        },
        {
          "shift": 2.63,
          "multiplicity": "dd",
          "coupling": [
            17.1,
            2.1
          ],
          "atom_index": "3\u03b2",
          "rdkit_index": [
            32
          ],
          "interchangable_index": []
        },
        {
          "shift": 6.34,
          "multiplicity": "br s",
          "coupling": [],
          "atom_index": "8",
          "rdkit_index": [
            40
          ],
          "interchangable_index": []
        },
        {
          "shift": 6.06,
          "multiplicity": "br s",
          "coupling": [],
          "atom_index": "6",
          "rdkit_index": [
            42
          ],
          "interchangable_index": []
        },
        {
          "shift": 7.3,
          "multiplicity": "d",
          "coupling": [
            8.4
          ],
          "atom_index": "2'",
          "rdkit_index": [
            35
          ],
          "interchangable_index": []
        },
        {
          "shift": 7.3,
          "multiplicity": "d",
          "coupling": [
            8.4
          ],
          "atom_index": "6'",
          "rdkit_index": [
            39
          ],
          "interchangable_index": []
        },
        {
          "shift": 6.78,
          "multiplicity": "d",
          "coupling": [
            8.4
          ],
          "atom_index": "3'",
          "rdkit_index": [
            36
          ],
          "interchangable_index": []
        },
        {
          "shift": 6.78,
          "multiplicity": "d",
          "coupling": [
            8.4
          ],
          "atom_index": "5'",
          "rdkit_index": [
            38
          ],
          "interchangable_index": []
        },
        {
          "shift": 5.39,
          "multiplicity": "d",
          "coupling": [
            7
          ],
          "atom_index": "1\"",
          "rdkit_index": [
            43
          ],
          "interchangable_index": []
        }
]

aligner = MolBlockAligner(example_curation_block, example_db_block)
c_result, h_result = aligner.align(example_c_values, example_h_values)

print("\nAligned 13C shifts:", c_result)
print("Aligned 1H shifts:", h_result)